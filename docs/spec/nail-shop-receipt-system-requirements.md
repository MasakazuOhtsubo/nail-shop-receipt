# ネイルショップ伝票管理システム 要件定義書

## 概要

ネイルショップ向けの伝票管理システムとして、メニューの管理、伝票の管理、売り上げ分析機能を提供する。コスト削減のためGitHub Pagesで静的ホスティングし、データの永続化と複数端末での同期にはGoogle スプレッドシートを使用する。

## ユーザストーリー

### ストーリー1: メニュー管理

- **である** ネイルサロンのオーナー **として**
- **私は** 施術メニューの追加・編集・削除 **をしたい**
- **そうすることで** 季節やトレンドに応じてメニューを柔軟に更新できる

### ストーリー2: 伝票作成と管理

- **である** ネイルサロンのスタッフ **として**
- **私は** 顧客の施術内容を伝票として記録 **をしたい**
- **そうすることで** 売上管理と顧客履歴を正確に把握できる

### ストーリー3: 売上分析

- **である** ネイルサロンのオーナー **として**
- **私は** 日別・月別の売上データを確認 **をしたい**
- **そうすることで** 経営判断に必要な情報を得られる

### ストーリー4: マルチデバイス対応

- **である** ネイルサロンのスタッフ **として**
- **私は** タブレットやスマートフォンから伝票を入力 **をしたい**
- **そうすることで** 接客しながら効率的に業務を行える

## 機能要件（EARS記法）

### 通常要件

- REQ-001: システムは メニュー（名称、価格、所要時間、カテゴリ）を登録・編集・削除できる機能を提供 しなければならない
- REQ-002: システムは 伝票（顧客名、施術日時、選択メニュー、担当スタッフ、支払い方法、メモ）を作成・保存できる機能を提供 しなければならない
- REQ-003: システムは 保存された伝票を日付や顧客名で検索・閲覧できる機能を提供 しなければならない
- REQ-004: システムは 日別・週別・月別の売上集計を表示する機能を提供 しなければならない
- REQ-005: システムは メニュー別の売上ランキングを表示する機能を提供 しなければならない

### 条件付き要件

- REQ-101: Google スプレッドシートへの接続が失敗した 場合、システムは エラーメッセージを表示し、ローカルストレージにデータを一時保存 しなければならない
- REQ-102: オフライン状態 の場合、システムは ローカルストレージを使用して基本機能を継続 しなければならない
- REQ-103: オンラインに復帰した 場合、システムは ローカルストレージのデータをGoogle スプレッドシートと同期 しなければならない

### 状態要件

- REQ-201: 伝票作成中 にある場合、システムは 入力内容を自動保存（30秒毎） しなければならない
- REQ-202: メニュー編集中 にある場合、システムは 変更前の状態を表示し、キャンセル可能 しなければならない

### オプション要件

- REQ-301: システムは 顧客の来店履歴から推奨メニューを提案 してもよい
- REQ-302: システムは 売上データをCSV形式でエクスポート してもよい
- REQ-303: システムは 伝票をPDF形式で印刷プレビュー表示 してもよい

### 制約要件

- REQ-401: システムは GitHub Pagesで静的ファイルとして動作 しなければならない
- REQ-402: システムは Google Sheets APIを使用してデータを永続化 しなければならない
- REQ-403: システムは 個人情報保護のため、顧客の詳細な個人情報（住所、電話番号等）を保存しない ようにしなければならない
- REQ-404: システムは レスポンシブデザインでモバイル端末に対応 しなければならない

## 非機能要件

### パフォーマンス

- NFR-001: 伝票の保存処理は3秒以内に完了すること
- NFR-002: 売上集計の表示は5秒以内に完了すること
- NFR-003: メニュー一覧の表示は1秒以内に完了すること

### セキュリティ

- NFR-101: Google認証を使用してスプレッドシートへのアクセスを制限すること
- NFR-102: APIキーは環境変数として管理し、ソースコードに含めないこと
- NFR-103: HTTPSプロトコルを使用してすべての通信を暗号化すること

### ユーザビリティ

- NFR-201: タッチ操作に最適化されたUIを提供すること
- NFR-202: 主要な操作は3タップ以内で完了できること
- NFR-203: エラーメッセージは日本語で分かりやすく表示すること

### 可用性

- NFR-301: オフライン時でも基本的な伝票作成機能が使用できること
- NFR-302: データの同期失敗時は自動リトライ機能を提供すること

## Edgeケース

### エラー処理

- EDGE-001: Google スプレッドシートの容量制限に達した場合、警告メッセージを表示し新しいシートの作成を促す
- EDGE-002: 同時編集による競合が発生した場合、最新のデータを優先し、変更履歴を保持する
- EDGE-003: 無効な価格（マイナス値、文字列等）が入力された場合、エラーメッセージを表示し再入力を促す

### 境界値

- EDGE-101: メニュー名は最大100文字まで、それ以上は切り詰めて警告を表示
- EDGE-102: 1日の伝票数が1000件を超えた場合、パフォーマンス警告を表示
- EDGE-103: 価格は0円から999,999円まで、範囲外はエラー表示

### 異常系

- EDGE-201: ブラウザのローカルストレージが満杯の場合、古いキャッシュデータを削除
- EDGE-202: Google認証トークンの有効期限切れの場合、再認証を促す
- EDGE-203: ネットワーク接続が不安定な場合、再接続を自動的に試行（最大3回）

## 受け入れ基準

### 機能テスト

- [ ] メニューの新規登録、編集、削除が正常に動作すること
- [ ] 伝票の作成、保存、検索が正常に動作すること
- [ ] 売上集計（日別・週別・月別）が正確に計算されること
- [ ] Google スプレッドシートとのデータ同期が正常に動作すること
- [ ] オフライン時のローカルストレージ保存が動作すること
- [ ] オンライン復帰時の自動同期が動作すること
- [ ] モバイル端末での表示・操作が適切に行えること

### 非機能テスト

- [ ] 各画面の表示速度が要件を満たすこと
- [ ] 100件の伝票データで売上集計が5秒以内に完了すること
- [ ] タブレット（iPad等）での操作性が良好であること
- [ ] Google認証によるアクセス制限が機能すること
- [ ] オフライン→オンライン切り替え時のデータ整合性が保たれること

### ユーザビリティテスト

- [ ] 初回利用者が説明なしで基本操作を理解できること
- [ ] 伝票作成が1分以内に完了できること
- [ ] エラーメッセージが理解しやすく、対処方法が明確であること